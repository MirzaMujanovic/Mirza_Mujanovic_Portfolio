<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Customer Churn Prediction | Marketing in R</title>
  <meta name="description" content="4 Customer Churn Prediction | Marketing in R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Customer Churn Prediction | Marketing in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Customer Churn Prediction | Marketing in R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="job-interview-social-media-data.html"/>
<link rel="next" href="prediction-with-rfm.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><B>Mirza Mujanovic Portfolio</B></a></li>

<li class="divider"></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About me</a></li>
<li class="part"><span><b>II Text Mining in Marketing</b></span></li>
<li class="chapter" data-level="1" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html"><i class="fa fa-check"></i><b>1</b> Emotions In Online Customer Reviews</a><ul>
<li class="chapter" data-level="" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#what-to-expect-in-this-article"><i class="fa fa-check"></i>What to expect in this article?</a></li>
<li class="chapter" data-level="1.1" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#dictionaries-for-nlp"><i class="fa fa-check"></i><b>1.1</b> Dictionaries for NLP</a></li>
<li class="chapter" data-level="1.2" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#data-set"><i class="fa fa-check"></i><b>1.2</b> Data set</a></li>
<li class="chapter" data-level="1.3" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#corpus-cleaning"><i class="fa fa-check"></i><b>1.3</b> Corpus cleaning</a></li>
<li class="chapter" data-level="1.4" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#visualisations-of-terms-frequency"><i class="fa fa-check"></i><b>1.4</b> Visualisations of terms frequency</a><ul>
<li class="chapter" data-level="1.4.1" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#bar-charts-with-the-most-frequent-terms"><i class="fa fa-check"></i><b>1.4.1</b> Bar charts with the most frequent terms</a></li>
<li class="chapter" data-level="1.4.2" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#wordcloud-with-the-most-frequent-terms"><i class="fa fa-check"></i><b>1.4.2</b> Wordcloud with the most frequent terms</a></li>
<li class="chapter" data-level="1.4.3" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#the-most-frequent-terms-indicating-emotions"><i class="fa fa-check"></i><b>1.4.3</b> The most frequent terms indicating emotions</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#sentiment-analysis"><i class="fa fa-check"></i><b>1.5</b> Sentiment analysis</a><ul>
<li class="chapter" data-level="1.5.1" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#polarity-timeline"><i class="fa fa-check"></i><b>1.5.1</b> Polarity timeline</a></li>
<li class="chapter" data-level="1.5.2" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#analysis-on-sentence-level"><i class="fa fa-check"></i><b>1.5.2</b> Analysis on sentence-level</a></li>
<li class="chapter" data-level="1.5.3" data-path="emotions-in-online-customer-reviews.html"><a href="emotions-in-online-customer-reviews.html#what-are-the-most-emotional-reviews"><i class="fa fa-check"></i><b>1.5.3</b> What are the most emotional reviews?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Social Media Analysis</b></span></li>
<li class="chapter" data-level="2" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html"><i class="fa fa-check"></i><b>2</b> Twitter Analysis for CO2mustGo initiative</a><ul>
<li class="chapter" data-level="" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#what-is-co2mustgo"><i class="fa fa-check"></i>What is CO2mustGO?</a></li>
<li class="chapter" data-level="2.1" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#sankey-diagram-energy-production-capacity"><i class="fa fa-check"></i><b>2.1</b> Sankey diagram: Energy production capacity</a></li>
<li class="chapter" data-level="" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#twitter-data-analysis"><i class="fa fa-check"></i>Twitter data analysis</a><ul>
<li class="chapter" data-level="2.1.1" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#data"><i class="fa fa-check"></i><b>2.1.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#text-cleaning-and-preprocessing"><i class="fa fa-check"></i><b>2.2</b> Text cleaning and preprocessing</a></li>
<li class="chapter" data-level="2.3" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#tweets-distribution"><i class="fa fa-check"></i><b>2.3</b> Tweets distribution</a></li>
<li class="chapter" data-level="2.4" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#word-frequency-in-tweets"><i class="fa fa-check"></i><b>2.4</b> Word Frequency in Tweets</a></li>
<li class="chapter" data-level="2.5" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#word-network-in-tweets"><i class="fa fa-check"></i><b>2.5</b> Word Network in Tweets</a></li>
<li class="chapter" data-level="2.6" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#wordcloud"><i class="fa fa-check"></i><b>2.6</b> Wordcloud</a></li>
<li class="chapter" data-level="2.7" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#word-associations"><i class="fa fa-check"></i><b>2.7</b> Word associations</a></li>
<li class="chapter" data-level="2.8" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#lda"><i class="fa fa-check"></i><b>2.8</b> LDA</a></li>
<li class="chapter" data-level="2.9" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#sentiment-analysis-1"><i class="fa fa-check"></i><b>2.9</b> Sentiment analysis</a></li>
<li class="chapter" data-level="2.10" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#visualize-the-emotions"><i class="fa fa-check"></i><b>2.10</b> Visualize the emotions</a></li>
<li class="chapter" data-level="2.11" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#top-retweeted-tweets"><i class="fa fa-check"></i><b>2.11</b> Top retweeted Tweets</a><ul>
<li class="chapter" data-level="" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#top-retweets-with-equal-or-more-than-60-mentions"><i class="fa fa-check"></i>Top retweets (with equal or more than 60 mentions)</a></li>
<li class="chapter" data-level="" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#interactive-graph-with-retweets-text"><i class="fa fa-check"></i>Interactive graph with retweets’ text</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#network-of-retweets"><i class="fa fa-check"></i><b>2.12</b> Network of retweets</a><ul>
<li class="chapter" data-level="2.12.1" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#where-do-people-tweet-the-most"><i class="fa fa-check"></i><b>2.12.1</b> Where do people tweet the most?</a></li>
<li class="chapter" data-level="2.12.2" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#who-are-the-users-who-retweet-the-most"><i class="fa fa-check"></i><b>2.12.2</b> Who are the users who retweet the most?</a></li>
<li class="chapter" data-level="2.12.3" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#who-are-the-most-retweeted-users"><i class="fa fa-check"></i><b>2.12.3</b> Who are the most retweeted users?</a></li>
<li class="chapter" data-level="2.12.4" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#who-are-users-important-for-connecting-with-others-in-network"><i class="fa fa-check"></i><b>2.12.4</b> Who are users important for connecting with others in network?</a></li>
<li class="chapter" data-level="2.12.5" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#clustering"><i class="fa fa-check"></i><b>2.12.5</b> Clustering</a></li>
<li class="chapter" data-level="2.12.6" data-path="twitter-analysis-for-co2mustgo-initiative.html"><a href="twitter-analysis-for-co2mustgo-initiative.html#community-detection"><i class="fa fa-check"></i><b>2.12.6</b> Community detection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="job-interview-social-media-data.html"><a href="job-interview-social-media-data.html"><i class="fa fa-check"></i><b>3</b> Job-Interview: Social Media Data</a><ul>
<li class="chapter" data-level="3.1" data-path="job-interview-social-media-data.html"><a href="job-interview-social-media-data.html#data-1"><i class="fa fa-check"></i><b>3.1</b> Data</a></li>
<li class="chapter" data-level="3.2" data-path="job-interview-social-media-data.html"><a href="job-interview-social-media-data.html#how-many-authors-have-interacted-in-the-database"><i class="fa fa-check"></i><b>3.2</b> How many authors have interacted in the database?</a></li>
<li class="chapter" data-level="3.3" data-path="job-interview-social-media-data.html"><a href="job-interview-social-media-data.html#which-one-is-the-most-used-media"><i class="fa fa-check"></i><b>3.3</b> Which one is the most used media?</a></li>
<li class="chapter" data-level="3.4" data-path="job-interview-social-media-data.html"><a href="job-interview-social-media-data.html#what-is-the-percentage-of-positive-negative-and-neutral-comments"><i class="fa fa-check"></i><b>3.4</b> What is the percentage of positive, negative and neutral comments?</a></li>
<li class="chapter" data-level="3.5" data-path="job-interview-social-media-data.html"><a href="job-interview-social-media-data.html#what-is-the-average-sentiment-in-twitter"><i class="fa fa-check"></i><b>3.5</b> What is the average sentiment in Twitter?</a></li>
<li class="chapter" data-level="3.6" data-path="job-interview-social-media-data.html"><a href="job-interview-social-media-data.html#visalisation-task"><i class="fa fa-check"></i><b>3.6</b> Visalisation task</a></li>
</ul></li>
<li class="part"><span><b>IV Customer analytics</b></span></li>
<li class="chapter" data-level="4" data-path="customer-churn-prediction.html"><a href="customer-churn-prediction.html"><i class="fa fa-check"></i><b>4</b> Customer Churn Prediction</a><ul>
<li class="chapter" data-level="4.1" data-path="customer-churn-prediction.html"><a href="customer-churn-prediction.html#why-predicting-customer-churn"><i class="fa fa-check"></i><b>4.1</b> Why predicting customer churn?</a></li>
<li class="chapter" data-level="4.2" data-path="customer-churn-prediction.html"><a href="customer-churn-prediction.html#data-2"><i class="fa fa-check"></i><b>4.2</b> Data</a></li>
<li class="chapter" data-level="4.3" data-path="customer-churn-prediction.html"><a href="customer-churn-prediction.html#data-pre-processing"><i class="fa fa-check"></i><b>4.3</b> Data Pre-processing</a></li>
<li class="chapter" data-level="4.4" data-path="customer-churn-prediction.html"><a href="customer-churn-prediction.html#data-partition"><i class="fa fa-check"></i><b>4.4</b> Data partition</a></li>
<li class="chapter" data-level="4.5" data-path="customer-churn-prediction.html"><a href="customer-churn-prediction.html#random-forest-model"><i class="fa fa-check"></i><b>4.5</b> Random Forest model</a></li>
<li class="chapter" data-level="4.6" data-path="customer-churn-prediction.html"><a href="customer-churn-prediction.html#evaluating-model"><i class="fa fa-check"></i><b>4.6</b> Evaluating Model</a></li>
<li class="chapter" data-level="4.7" data-path="customer-churn-prediction.html"><a href="customer-churn-prediction.html#references"><i class="fa fa-check"></i><b>4.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html"><i class="fa fa-check"></i><b>5</b> Prediction with RFM</a><ul>
<li class="chapter" data-level="5.1" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#background-information"><i class="fa fa-check"></i><b>5.1</b> Background information</a></li>
<li class="chapter" data-level="5.2" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#recency---frequency---monetary-analysis"><i class="fa fa-check"></i><b>5.2</b> Recency - Frequency - Monetary Analysis</a></li>
<li class="chapter" data-level="5.3" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#assignment"><i class="fa fa-check"></i><b>5.3</b> Assignment</a></li>
<li class="chapter" data-level="5.4" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#visaul-exploration"><i class="fa fa-check"></i><b>5.4</b> Visaul exploration</a></li>
<li class="chapter" data-level="5.5" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#overall-response-rate"><i class="fa fa-check"></i><b>5.5</b> Overall response rate</a></li>
<li class="chapter" data-level="5.6" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#prediction-of-response-rate"><i class="fa fa-check"></i><b>5.6</b> Prediction of response rate</a></li>
<li class="chapter" data-level="5.7" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#prediction-of-response-rate-with-3-segments"><i class="fa fa-check"></i><b>5.7</b> Prediction of response rate with 3 segments</a></li>
<li class="chapter" data-level="5.8" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#efficiency-of-the-predicitions"><i class="fa fa-check"></i><b>5.8</b> Efficiency of the predicitions</a></li>
<li class="chapter" data-level="5.9" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#summary-of-the-solution"><i class="fa fa-check"></i><b>5.9</b> Summary of the solution</a></li>
<li class="chapter" data-level="5.10" data-path="prediction-with-rfm.html"><a href="prediction-with-rfm.html#reference"><i class="fa fa-check"></i><b>5.10</b> Reference</a></li>
</ul></li>
<li class="part"><span><b>V Recommendation system</b></span></li>
<li class="chapter" data-level="6" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html"><i class="fa fa-check"></i><b>6</b> Recommender For Beauty Products</a><ul>
<li class="chapter" data-level="6.1" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#data-collection"><i class="fa fa-check"></i><b>6.1</b> Data collection</a></li>
<li class="chapter" data-level="6.2" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#data-preparation-and-preprocessing"><i class="fa fa-check"></i><b>6.2</b> Data preparation and preprocessing</a><ul>
<li class="chapter" data-level="6.2.1" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#packages"><i class="fa fa-check"></i><b>6.2.1</b> Packages</a></li>
<li class="chapter" data-level="6.2.2" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#data-collection-1"><i class="fa fa-check"></i><b>6.2.2</b> Data collection</a></li>
<li class="chapter" data-level="6.2.3" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#how-many-times-users-reviewed-products"><i class="fa fa-check"></i><b>6.2.3</b> How many times users reviewed products?</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>6.3</b> Exploratory data analysis</a><ul>
<li class="chapter" data-level="6.3.1" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#head-of-data"><i class="fa fa-check"></i><b>6.3.1</b> Head of data</a></li>
<li class="chapter" data-level="6.3.2" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#how-many-unique-products-are-reviewed"><i class="fa fa-check"></i><b>6.3.2</b> How many unique products are reviewed?</a></li>
<li class="chapter" data-level="6.3.3" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#how-many-reviewers-do-we-have"><i class="fa fa-check"></i><b>6.3.3</b> How many reviewers do we have?</a></li>
<li class="chapter" data-level="6.3.4" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#how-many-scores-do-we-have"><i class="fa fa-check"></i><b>6.3.4</b> How many scores do we have?</a></li>
<li class="chapter" data-level="6.3.5" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#what-is-the-distribution-of-ratings"><i class="fa fa-check"></i><b>6.3.5</b> What is the distribution of ratings?</a></li>
<li class="chapter" data-level="6.3.6" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#what-is-the-average-number-of-reviews-per-user"><i class="fa fa-check"></i><b>6.3.6</b> What is the average number of reviews per user?</a></li>
<li class="chapter" data-level="6.3.7" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#what-is-the-average-score-per-user"><i class="fa fa-check"></i><b>6.3.7</b> What is the average score per user?</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#building-a-model"><i class="fa fa-check"></i><b>6.4</b> Building a model</a><ul>
<li class="chapter" data-level="6.4.1" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#final-data-outlook"><i class="fa fa-check"></i><b>6.4.1</b> Final data outlook</a></li>
<li class="chapter" data-level="6.4.2" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#subsetting-data"><i class="fa fa-check"></i><b>6.4.2</b> Subsetting data</a></li>
<li class="chapter" data-level="6.4.3" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#formatting-data"><i class="fa fa-check"></i><b>6.4.3</b> Formatting data</a></li>
<li class="chapter" data-level="6.4.4" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#inspecting-real-rating-matrix"><i class="fa fa-check"></i><b>6.4.4</b> Inspecting real rating matrix</a></li>
<li class="chapter" data-level="6.4.5" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#building-a-recommender"><i class="fa fa-check"></i><b>6.4.5</b> Building a recommender</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#interpretation-and-managerial-implications"><i class="fa fa-check"></i><b>6.5</b> Interpretation and managerial implications</a><ul>
<li class="chapter" data-level="6.5.1" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#identification-of-the-recommended-products"><i class="fa fa-check"></i><b>6.5.1</b> Identification of the recommended products</a></li>
<li class="chapter" data-level="6.5.2" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#implications"><i class="fa fa-check"></i><b>6.5.2</b> Implications</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#bonus-analysis-text-mining"><i class="fa fa-check"></i><b>6.6</b> Bonus analysis: Text Mining</a><ul>
<li class="chapter" data-level="6.6.1" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#wordcloud-1"><i class="fa fa-check"></i><b>6.6.1</b> Wordcloud</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#future-work"><i class="fa fa-check"></i><b>6.7</b> Future work</a></li>
<li class="chapter" data-level="6.8" data-path="recommender-for-beauty-products.html"><a href="recommender-for-beauty-products.html#limitations"><i class="fa fa-check"></i><b>6.8</b> Limitations</a></li>
</ul></li>
<li class="part"><span><b>VI Shiny Apps</b></span></li>
<li class="chapter" data-level="7" data-path="covid-19-dashboard.html"><a href="covid-19-dashboard.html"><i class="fa fa-check"></i><b>7</b> COVID 19 Dashboard</a><ul>
<li class="chapter" data-level="7.1" data-path="covid-19-dashboard.html"><a href="covid-19-dashboard.html#data-3"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="covid-19-dashboard.html"><a href="covid-19-dashboard.html#curve-of-confirmed-cases"><i class="fa fa-check"></i><b>7.2</b> Curve of confirmed cases</a></li>
<li class="chapter" data-level="7.3" data-path="covid-19-dashboard.html"><a href="covid-19-dashboard.html#total-cases-per-1-million-people"><i class="fa fa-check"></i><b>7.3</b> Total cases per 1 million people</a></li>
<li class="chapter" data-level="7.4" data-path="covid-19-dashboard.html"><a href="covid-19-dashboard.html#deaths-vs-recovered"><i class="fa fa-check"></i><b>7.4</b> Deaths vs Recovered</a></li>
<li class="chapter" data-level="7.5" data-path="covid-19-dashboard.html"><a href="covid-19-dashboard.html#active-cases-vs-new-cases"><i class="fa fa-check"></i><b>7.5</b> Active cases vs New cases</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://at.linkedin.com/in/mirzamujanovic?trk=profile-badge" target="blank">LinkedIn: Mirza Mujanovic</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Marketing in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="customer-churn-prediction" class="section level1">
<h1><span class="header-section-number">4</span> Customer Churn Prediction</h1>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-82"></span>
<img src="Graphics/churn.png" alt="Foto from technologyadvice.com" width="50%" />
<p class="caption">
Figure 4.1: Foto from technologyadvice.com
</p>
</div>
<p>In this project I decided to use Telco dataset, a dataset from the IBM
Watson Analytics community, and apply Random Forest learning method to make prediction whether a customer will churn or not based on features and information about customers who churned within the last month or are still customers.</p>
<div id="why-predicting-customer-churn" class="section level2">
<h2><span class="header-section-number">4.1</span> Why predicting customer churn?</h2>
<div style="text-align: justify">
<p>Consumer churn prediction models are developed to determine which consumers are likely to churn and to encourage an effective segmentation of the customer base to enable companies to approach customers at risk of leaving with a retention strategy. Such a prediction models help small marketing budgets to be wisely utilized to minimize turnover, i.e. to maximize the return on marketing expenditure (ROMI). Customer retention has usually been found to be extremely profitable for companies because it costs five to six times more to acquire new customer than to retain an existing customer. Additionally, long-term customers are more profitable, appear to be less susceptible to aggressive marketing activities, appear to be less costly to service, and can create new referrals by positive word-of - mouth.</p>
<p>Consequently, even a small improvement in customer retention may yield significant returns.</p>
<p><em>Note: for references take a look at the Reference section</em></p>
</div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="customer-churn-prediction.html#cb99-1"></a><span class="kw">options</span>(<span class="dt">stringsAsFactor=</span><span class="ot">TRUE</span>)</span>
<span id="cb99-2"><a href="customer-churn-prediction.html#cb99-2"></a><span class="kw">library</span>(curl)</span>
<span id="cb99-3"><a href="customer-churn-prediction.html#cb99-3"></a><span class="kw">library</span>(readr)</span>
<span id="cb99-4"><a href="customer-churn-prediction.html#cb99-4"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb99-5"><a href="customer-churn-prediction.html#cb99-5"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb99-6"><a href="customer-churn-prediction.html#cb99-6"></a><span class="kw">library</span>(randomForest)</span>
<span id="cb99-7"><a href="customer-churn-prediction.html#cb99-7"></a><span class="kw">library</span>(caret)</span></code></pre></div>
</div>
<div id="data-2" class="section level2">
<h2><span class="header-section-number">4.2</span> Data</h2>
<ul>
<li>The data set includes information about:
<ul>
<li>Customers who left within the last month – the column is called <strong>Churn</strong>.</li>
<li>Services that each customer has signed up for – phone, multiple lines, internet, online security, online backup, device protection, tech support, and streaming TV and movies.</li>
<li>Customer account information – how long they’ve been a customer, contract, payment method, paperless billing, monthly charges, and total charges.</li>
<li>Demographic info about customers – gender, age range, and if they have partners and dependents.</li>
</ul></li>
</ul>
<table class=" lightable-paper lightable-hover" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
Topic
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Gender
</td>
<td style="text-align:left;">
Whether the customer is a male or a female
</td>
</tr>
<tr>
<td style="text-align:left;">
SeniorCitizen
</td>
<td style="text-align:left;">
Whether the customer is a senior citizen or not (1, 0)
</td>
</tr>
<tr>
<td style="text-align:left;">
Partner
</td>
<td style="text-align:left;">
Whether the customer has a partner or not (Yes, No)
</td>
</tr>
<tr>
<td style="text-align:left;">
Dependents
</td>
<td style="text-align:left;">
Whether the customer has dependents or not (Yes, No)
</td>
</tr>
<tr>
<td style="text-align:left;">
Tenure
</td>
<td style="text-align:left;">
Number of months the customer has stayed with the company
</td>
</tr>
<tr>
<td style="text-align:left;">
PhoneService
</td>
<td style="text-align:left;">
Whether the customer has a phone service or not (Yes, No)
</td>
</tr>
<tr>
<td style="text-align:left;">
MultipleLines
</td>
<td style="text-align:left;">
Whether the customer has multiple lines or not (Yes, No, No phone service)
</td>
</tr>
<tr>
<td style="text-align:left;">
InternetService
</td>
<td style="text-align:left;">
Customer’s internet service provider (DSL, Fiber optic, No)
</td>
</tr>
<tr>
<td style="text-align:left;">
OnlineSecurity
</td>
<td style="text-align:left;">
Whether the customer has online security or not (Yes, No, No internet service)
</td>
</tr>
<tr>
<td style="text-align:left;">
OnlineBackup
</td>
<td style="text-align:left;">
Whether the customer has online backup or not (Yes, No, No internet service)
</td>
</tr>
<tr>
<td style="text-align:left;">
DeviceProtection
</td>
<td style="text-align:left;">
Whether the customer has device protection or not (Yes, No, No internet service)
</td>
</tr>
<tr>
<td style="text-align:left;">
TechSupport
</td>
<td style="text-align:left;">
Whether the customer has tech support or not (Yes, No, No internet service)
</td>
</tr>
<tr>
<td style="text-align:left;">
StreamingTV
</td>
<td style="text-align:left;">
Whether the customer has streaming TV or not (Yes, No, No internet service)
</td>
</tr>
<tr>
<td style="text-align:left;">
StreamingMovie
</td>
<td style="text-align:left;">
Whether the customer has streaming movies or not (Yes, No, No internet service)
</td>
</tr>
<tr>
<td style="text-align:left;">
Contract
</td>
<td style="text-align:left;">
The contract term of the customer (Month-to-month, One year, Two year)
</td>
</tr>
<tr>
<td style="text-align:left;">
PaperlessBilling
</td>
<td style="text-align:left;">
Whether the customer has paperless billing or not (Yes, No)
</td>
</tr>
<tr>
<td style="text-align:left;">
PaymentMethod
</td>
<td style="text-align:left;">
The customer’s payment method (Electronic check, Mailed check, Bank transfer (automatic), Credit card (automatic))
</td>
</tr>
<tr>
<td style="text-align:left;">
MonthlyCharges
</td>
<td style="text-align:left;">
The amount charged to the customer monthly
</td>
</tr>
<tr>
<td style="text-align:left;">
TotalCharges
</td>
<td style="text-align:left;">
The total amount charged to the customer
</td>
</tr>
<tr>
<td style="text-align:left;">
Churn
</td>
<td style="text-align:left;">
Whether the customer churned or not (Yes or No)
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> Information collected from <a href="https://www.kaggle.com/blastchar/telco-customer-churn" class="uri">https://www.kaggle.com/blastchar/telco-customer-churn</a>
</td>
</tr>
</tfoot>
</table>
<p>Here are dimensions of our data set and first 6 rows:</p>
<pre><code>##   customerID gender SeniorCitizen Partner Dependents tenure PhoneService
## 1 7590-VHVEG Female             0     Yes         No      1           No
## 2 5575-GNVDE   Male             0      No         No     34          Yes
## 3 3668-QPYBK   Male             0      No         No      2          Yes
## 4 7795-CFOCW   Male             0      No         No     45           No
## 5 9237-HQITU Female             0      No         No      2          Yes
## 6 9305-CDSKC Female             0      No         No      8          Yes
##      MultipleLines InternetService OnlineSecurity OnlineBackup DeviceProtection
## 1 No phone service             DSL             No          Yes               No
## 2               No             DSL            Yes           No              Yes
## 3               No             DSL            Yes          Yes               No
## 4 No phone service             DSL            Yes           No              Yes
## 5               No     Fiber optic             No           No               No
## 6              Yes     Fiber optic             No           No              Yes
##   TechSupport StreamingTV StreamingMovies       Contract PaperlessBilling
## 1          No          No              No Month-to-month              Yes
## 2          No          No              No       One year               No
## 3          No          No              No Month-to-month              Yes
## 4         Yes          No              No       One year               No
## 5          No          No              No Month-to-month              Yes
## 6          No         Yes             Yes Month-to-month              Yes
##               PaymentMethod MonthlyCharges TotalCharges Churn
## 1          Electronic check          29.85        29.85    No
## 2              Mailed check          56.95      1889.50    No
## 3              Mailed check          53.85       108.15   Yes
## 4 Bank transfer (automatic)          42.30      1840.75    No
## 5          Electronic check          70.70       151.65   Yes
## 6          Electronic check          99.65       820.50   Yes</code></pre>
</div>
<div id="data-pre-processing" class="section level2">
<h2><span class="header-section-number">4.3</span> Data Pre-processing</h2>
<p>First, we need to remove rows which have at least one NA as a value:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="customer-churn-prediction.html#cb101-1"></a><span class="co"># Drop Nas</span></span>
<span id="cb101-2"><a href="customer-churn-prediction.html#cb101-2"></a><span class="kw">dim</span>(x)</span></code></pre></div>
<pre><code>## [1] 7043   21</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="customer-churn-prediction.html#cb103-1"></a>x &lt;-<span class="st"> </span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>()</span>
<span id="cb103-2"><a href="customer-churn-prediction.html#cb103-2"></a><span class="kw">dim</span>(x)</span></code></pre></div>
<pre><code>## [1] 7032   21</code></pre>
<p>11 are removed from the data set as they held at least one NA as a value. Next, we need to prepare our data set in terms of data types. In order to use Random Forest for churn prediction, we need to make sure that our categorical are represented in numeric manner.</p>
<p>Therefore, all categorical variables will be converted to factors.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="customer-churn-prediction.html#cb105-1"></a><span class="co"># Categorical variables to factors</span></span>
<span id="cb105-2"><a href="customer-churn-prediction.html#cb105-2"></a>x[<span class="kw">c</span>(<span class="st">&quot;Partner&quot;</span>,<span class="st">&quot;Dependents&quot;</span>,<span class="st">&quot;PhoneService&quot;</span>,<span class="st">&quot;gender&quot;</span>,<span class="st">&quot;MultipleLines&quot;</span>,<span class="st">&quot;InternetService&quot;</span>,<span class="st">&quot;OnlineSecurity&quot;</span>,<span class="st">&quot;OnlineBackup&quot;</span>,<span class="st">&quot;DeviceProtection&quot;</span>,<span class="st">&quot;TechSupport&quot;</span>,<span class="st">&quot;StreamingTV&quot;</span>,<span class="st">&quot;Contract&quot;</span>,<span class="st">&quot;StreamingMovies&quot;</span>,<span class="st">&quot;PaperlessBilling&quot;</span>,<span class="st">&quot;PaymentMethod&quot;</span>,<span class="st">&quot;Churn&quot;</span>)]&lt;-<span class="kw">lapply</span>(x[<span class="kw">c</span>(<span class="st">&quot;Partner&quot;</span>,<span class="st">&quot;Dependents&quot;</span>,<span class="st">&quot;PhoneService&quot;</span>,<span class="st">&quot;gender&quot;</span>,<span class="st">&quot;MultipleLines&quot;</span>,<span class="st">&quot;InternetService&quot;</span>,<span class="st">&quot;OnlineSecurity&quot;</span>,<span class="st">&quot;OnlineBackup&quot;</span>,<span class="st">&quot;DeviceProtection&quot;</span>,<span class="st">&quot;TechSupport&quot;</span>,<span class="st">&quot;StreamingTV&quot;</span>,<span class="st">&quot;Contract&quot;</span>,<span class="st">&quot;StreamingMovies&quot;</span>,<span class="st">&quot;PaperlessBilling&quot;</span>,<span class="st">&quot;PaymentMethod&quot;</span>,<span class="st">&quot;Churn&quot;</span>)], as.factor)</span>
<span id="cb105-3"><a href="customer-churn-prediction.html#cb105-3"></a><span class="kw">str</span>(x)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    7032 obs. of  21 variables:
##  $ customerID      : chr  &quot;7590-VHVEG&quot; &quot;5575-GNVDE&quot; &quot;3668-QPYBK&quot; &quot;7795-CFOCW&quot; ...
##  $ gender          : Factor w/ 2 levels &quot;Female&quot;,&quot;Male&quot;: 1 2 2 2 1 1 2 1 1 2 ...
##  $ SeniorCitizen   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Partner         : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 1 1 1 1 1 1 1 2 1 ...
##  $ Dependents      : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 1 1 2 1 1 2 ...
##  $ tenure          : int  1 34 2 45 2 8 22 10 28 62 ...
##  $ PhoneService    : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 2 2 1 2 2 2 1 2 2 ...
##  $ MultipleLines   : Factor w/ 3 levels &quot;No&quot;,&quot;No phone service&quot;,..: 2 1 1 2 1 3 3 2 3 1 ...
##  $ InternetService : Factor w/ 3 levels &quot;DSL&quot;,&quot;Fiber optic&quot;,..: 1 1 1 1 2 2 2 1 2 1 ...
##  $ OnlineSecurity  : Factor w/ 3 levels &quot;No&quot;,&quot;No internet service&quot;,..: 1 3 3 3 1 1 1 3 1 3 ...
##  $ OnlineBackup    : Factor w/ 3 levels &quot;No&quot;,&quot;No internet service&quot;,..: 3 1 3 1 1 1 3 1 1 3 ...
##  $ DeviceProtection: Factor w/ 3 levels &quot;No&quot;,&quot;No internet service&quot;,..: 1 3 1 3 1 3 1 1 3 1 ...
##  $ TechSupport     : Factor w/ 3 levels &quot;No&quot;,&quot;No internet service&quot;,..: 1 1 1 3 1 1 1 1 3 1 ...
##  $ StreamingTV     : Factor w/ 3 levels &quot;No&quot;,&quot;No internet service&quot;,..: 1 1 1 1 1 3 3 1 3 1 ...
##  $ StreamingMovies : Factor w/ 3 levels &quot;No&quot;,&quot;No internet service&quot;,..: 1 1 1 1 1 3 1 1 3 1 ...
##  $ Contract        : Factor w/ 3 levels &quot;Month-to-month&quot;,..: 1 2 1 2 1 1 1 1 1 2 ...
##  $ PaperlessBilling: Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 1 2 1 2 2 2 1 2 1 ...
##  $ PaymentMethod   : Factor w/ 4 levels &quot;Bank transfer (automatic)&quot;,..: 3 4 4 1 3 3 2 4 3 1 ...
##  $ MonthlyCharges  : num  29.9 57 53.9 42.3 70.7 ...
##  $ TotalCharges    : num  29.9 1889.5 108.2 1840.8 151.7 ...
##  $ Churn           : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 2 1 2 2 1 1 2 1 ...</code></pre>
<p>We aim to convert our data set into matrix with only 0s and 1s. Thus, all binomial variables can be turned to 0s and 1s in the following way:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="customer-churn-prediction.html#cb107-1"></a><span class="co"># Binomial categorical variables to 0 and 1</span></span>
<span id="cb107-2"><a href="customer-churn-prediction.html#cb107-2"></a>x<span class="op">$</span>PhoneService &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(x<span class="op">$</span>PhoneService)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb107-3"><a href="customer-churn-prediction.html#cb107-3"></a>x<span class="op">$</span>Partner &lt;-<span class="kw">as.numeric</span>(x<span class="op">$</span>Partner)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb107-4"><a href="customer-churn-prediction.html#cb107-4"></a>x<span class="op">$</span>Dependents &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(x<span class="op">$</span>Dependents)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb107-5"><a href="customer-churn-prediction.html#cb107-5"></a>x<span class="op">$</span>Churn &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(x<span class="op">$</span>Churn)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb107-6"><a href="customer-churn-prediction.html#cb107-6"></a>x<span class="op">$</span>gender &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(x<span class="op">$</span>gender)<span class="op">-</span><span class="dv">1</span></span></code></pre></div>
<p>Now it is left to convert multi-class variables 0s and 1s. Before we do it, let’s inspect our data a bit:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="customer-churn-prediction.html#cb108-1"></a><span class="co">## Categorical variables with more than 2 categories</span></span>
<span id="cb108-2"><a href="customer-churn-prediction.html#cb108-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">2</span>))</span>
<span id="cb108-3"><a href="customer-churn-prediction.html#cb108-3"></a><span class="co"># Multiple lines</span></span>
<span id="cb108-4"><a href="customer-churn-prediction.html#cb108-4"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(MultipleLines,<span class="dt">fill=</span>MultipleLines)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb108-5"><a href="customer-churn-prediction.html#cb108-5"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb108-6"><a href="customer-churn-prediction.html#cb108-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Multiple lines&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="customer-churn-prediction.html#cb109-1"></a><span class="co"># Internet services</span></span>
<span id="cb109-2"><a href="customer-churn-prediction.html#cb109-2"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(InternetService,<span class="dt">fill=</span>InternetService)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb109-3"><a href="customer-churn-prediction.html#cb109-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb109-4"><a href="customer-churn-prediction.html#cb109-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Internet service&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="customer-churn-prediction.html#cb110-1"></a><span class="co"># OnlineSecurity</span></span>
<span id="cb110-2"><a href="customer-churn-prediction.html#cb110-2"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(OnlineSecurity,<span class="dt">fill=</span>OnlineSecurity)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb110-3"><a href="customer-churn-prediction.html#cb110-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb110-4"><a href="customer-churn-prediction.html#cb110-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;OnlineSecurity&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-3.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="customer-churn-prediction.html#cb111-1"></a><span class="co"># OnlineBackup</span></span>
<span id="cb111-2"><a href="customer-churn-prediction.html#cb111-2"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(OnlineBackup,<span class="dt">fill=</span>OnlineBackup)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb111-3"><a href="customer-churn-prediction.html#cb111-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb111-4"><a href="customer-churn-prediction.html#cb111-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;OnlineBackup&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-4.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="customer-churn-prediction.html#cb112-1"></a><span class="co"># DeviceProtection</span></span>
<span id="cb112-2"><a href="customer-churn-prediction.html#cb112-2"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(DeviceProtection,<span class="dt">fill=</span>DeviceProtection)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb112-3"><a href="customer-churn-prediction.html#cb112-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb112-4"><a href="customer-churn-prediction.html#cb112-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;DeviceProtection&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-5.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="customer-churn-prediction.html#cb113-1"></a><span class="co"># TechSupport</span></span>
<span id="cb113-2"><a href="customer-churn-prediction.html#cb113-2"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(TechSupport,<span class="dt">fill=</span>TechSupport)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb113-3"><a href="customer-churn-prediction.html#cb113-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb113-4"><a href="customer-churn-prediction.html#cb113-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;TechSupport&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-6.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="customer-churn-prediction.html#cb114-1"></a><span class="co"># StreamingTV</span></span>
<span id="cb114-2"><a href="customer-churn-prediction.html#cb114-2"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(StreamingTV,<span class="dt">fill=</span>StreamingTV)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb114-3"><a href="customer-churn-prediction.html#cb114-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb114-4"><a href="customer-churn-prediction.html#cb114-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;StreamingTV&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-7.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="customer-churn-prediction.html#cb115-1"></a><span class="co"># StreamingMovies</span></span>
<span id="cb115-2"><a href="customer-churn-prediction.html#cb115-2"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(StreamingMovies,<span class="dt">fill=</span>StreamingMovies)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb115-3"><a href="customer-churn-prediction.html#cb115-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb115-4"><a href="customer-churn-prediction.html#cb115-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;StreamingMovies&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-8.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="customer-churn-prediction.html#cb116-1"></a><span class="co"># Contract</span></span>
<span id="cb116-2"><a href="customer-churn-prediction.html#cb116-2"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(Contract,<span class="dt">fill=</span>Contract)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb116-3"><a href="customer-churn-prediction.html#cb116-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb116-4"><a href="customer-churn-prediction.html#cb116-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Contract&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-9.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="customer-churn-prediction.html#cb117-1"></a><span class="co"># PaymentMethod</span></span>
<span id="cb117-2"><a href="customer-churn-prediction.html#cb117-2"></a><span class="kw">ggplot</span>(x, <span class="kw">aes</span>(PaymentMethod,<span class="dt">fill=</span>PaymentMethod)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb117-3"><a href="customer-churn-prediction.html#cb117-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb117-4"><a href="customer-churn-prediction.html#cb117-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;PaymentMethod&quot;</span>,<span class="dt">x=</span><span class="st">&quot;&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-89-10.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can apply one hot encoding to our data set by using R’s base function <code>model.matrix</code>. In the code below, ~.+0 leads to encoding of all categorical variables without producing an intercept.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="customer-churn-prediction.html#cb118-1"></a><span class="co"># One-hot encoding</span></span>
<span id="cb118-2"><a href="customer-churn-prediction.html#cb118-2"></a>x.mat&lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>MultipleLines<span class="op">+</span>InternetService<span class="op">+</span>OnlineSecurity<span class="op">+</span>OnlineBackup<span class="op">+</span>DeviceProtection<span class="op">+</span>TechSupport<span class="op">+</span>StreamingTV<span class="op">+</span>Contract<span class="op">+</span>StreamingMovies<span class="op">+</span>PaperlessBilling<span class="op">+</span>PaymentMethod<span class="op">+</span><span class="dv">0</span>,<span class="dt">data =</span> x)</span></code></pre></div>
<p>Now is our data set pre-processed:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="customer-churn-prediction.html#cb119-1"></a><span class="co"># Creation of the final data frame with 0s and 1s</span></span>
<span id="cb119-2"><a href="customer-churn-prediction.html#cb119-2"></a>final.df&lt;-<span class="kw">as.data.frame</span>(x.mat)</span>
<span id="cb119-3"><a href="customer-churn-prediction.html#cb119-3"></a>final.df&lt;-<span class="st"> </span><span class="kw">cbind</span>(x.mat,x<span class="op">$</span>tenure,x<span class="op">$</span>TotalCharges,x<span class="op">$</span>MonthlyCharges,x<span class="op">$</span>PhoneService,x<span class="op">$</span>Partner,x<span class="op">$</span>Dependents,x<span class="op">$</span>gender,x<span class="op">$</span>Churn)</span>
<span id="cb119-4"><a href="customer-churn-prediction.html#cb119-4"></a><span class="kw">colnames</span>(final.df)[<span class="dv">24</span><span class="op">:</span><span class="dv">31</span>]&lt;-<span class="kw">c</span>(<span class="st">&quot;tenure&quot;</span>,<span class="st">&quot;TotalCharges&quot;</span>,<span class="st">&quot;MonthlyCharges&quot;</span>,<span class="st">&quot;PhoneService&quot;</span>,<span class="st">&quot;Partner&quot;</span>,<span class="st">&quot;Dependents&quot;</span>,<span class="st">&quot;gender&quot;</span>,<span class="st">&quot;Churn&quot;</span>)</span></code></pre></div>
</div>
<div id="data-partition" class="section level2">
<h2><span class="header-section-number">4.4</span> Data partition</h2>
<p>Now we need to split our data into test and train data. The proportion is 70:30.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="customer-churn-prediction.html#cb120-1"></a><span class="co"># Creation of training and test data sets</span></span>
<span id="cb120-2"><a href="customer-churn-prediction.html#cb120-2"></a>index &lt;-<span class="st"> </span>caret<span class="op">::</span><span class="kw">createDataPartition</span>(x<span class="op">$</span>Churn, <span class="dt">p =</span> <span class="fl">0.7</span>, <span class="dt">list =</span> F)</span>
<span id="cb120-3"><a href="customer-churn-prediction.html#cb120-3"></a>train &lt;-<span class="st"> </span>final.df[index,]</span>
<span id="cb120-4"><a href="customer-churn-prediction.html#cb120-4"></a>test &lt;-<span class="st"> </span>final.df[<span class="op">-</span>index,]</span>
<span id="cb120-5"><a href="customer-churn-prediction.html#cb120-5"></a></span>
<span id="cb120-6"><a href="customer-churn-prediction.html#cb120-6"></a><span class="co"># Partitioning test data</span></span>
<span id="cb120-7"><a href="customer-churn-prediction.html#cb120-7"></a>x_test &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(test[,<span class="op">-</span><span class="dv">31</span>])  </span>
<span id="cb120-8"><a href="customer-churn-prediction.html#cb120-8"></a>y_test &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(test[,<span class="dv">31</span>])</span>
<span id="cb120-9"><a href="customer-churn-prediction.html#cb120-9"></a></span>
<span id="cb120-10"><a href="customer-churn-prediction.html#cb120-10"></a><span class="co"># Partitioning train data</span></span>
<span id="cb120-11"><a href="customer-churn-prediction.html#cb120-11"></a>x_train &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(train[,<span class="op">-</span><span class="dv">31</span>])</span>
<span id="cb120-12"><a href="customer-churn-prediction.html#cb120-12"></a>y_train &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(train[,<span class="dv">31</span>])</span></code></pre></div>
<p>To train our random forest model we use function <code>randomForest()</code>. At this point we will not aim to fine tune our model, so we will define just two parameters,<code>ntree</code> and <code>maxnodes</code>:</p>
<ul>
<li><code>ntree</code> defines the number of trees to build in the forest.</li>
<li><code>maxnodes</code> defines the maximum number of terminal nodes each tree in the forest can have.</li>
</ul>
</div>
<div id="random-forest-model" class="section level2">
<h2><span class="header-section-number">4.5</span> Random Forest model</h2>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="customer-churn-prediction.html#cb121-1"></a><span class="co"># Random Forest</span></span>
<span id="cb121-2"><a href="customer-churn-prediction.html#cb121-2"></a><span class="co"># Training</span></span>
<span id="cb121-3"><a href="customer-churn-prediction.html#cb121-3"></a><span class="kw">library</span>(randomForest)</span>
<span id="cb121-4"><a href="customer-churn-prediction.html#cb121-4"></a>rfModel &lt;-<span class="st"> </span><span class="kw">randomForest</span>(<span class="dt">x=</span>x_train,</span>
<span id="cb121-5"><a href="customer-churn-prediction.html#cb121-5"></a>                        <span class="dt">y=</span><span class="kw">factor</span>(y_train),</span>
<span id="cb121-6"><a href="customer-churn-prediction.html#cb121-6"></a>                        <span class="dt">ntree=</span><span class="dv">500</span>,</span>
<span id="cb121-7"><a href="customer-churn-prediction.html#cb121-7"></a>                        <span class="dt">maxnodes=</span><span class="dv">24</span>)</span></code></pre></div>
<p>Since predictions are made based on features our model was trained on, it is possible to observe importance of each feature. The more important a feature, the greater influence it exerts on predictions:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="customer-churn-prediction.html#cb122-1"></a>importance_features &lt;-<span class="st"> </span>randomForest<span class="op">::</span><span class="kw">importance</span>(rfModel)</span>
<span id="cb122-2"><a href="customer-churn-prediction.html#cb122-2"></a>importance_features &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(importance_features)</span>
<span id="cb122-3"><a href="customer-churn-prediction.html#cb122-3"></a>importance_features<span class="op">$</span>features &lt;-<span class="st"> </span><span class="kw">row.names</span>(importance_features)</span>
<span id="cb122-4"><a href="customer-churn-prediction.html#cb122-4"></a>importance_features &lt;-<span class="st"> </span>importance_features[<span class="kw">order</span>(importance_features<span class="op">$</span>MeanDecreaseGini ,<span class="dt">decreasing =</span> <span class="ot">TRUE</span>),]</span>
<span id="cb122-5"><a href="customer-churn-prediction.html#cb122-5"></a></span>
<span id="cb122-6"><a href="customer-churn-prediction.html#cb122-6"></a><span class="kw">library</span>(plotly)</span>
<span id="cb122-7"><a href="customer-churn-prediction.html#cb122-7"></a>p&lt;-<span class="kw">ggplot</span>(importance_features) <span class="op">+</span></span>
<span id="cb122-8"><a href="customer-churn-prediction.html#cb122-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="kw">reorder</span>(features,MeanDecreaseGini),MeanDecreaseGini),<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="op">+</span></span>
<span id="cb122-9"><a href="customer-churn-prediction.html#cb122-9"></a><span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb122-10"><a href="customer-churn-prediction.html#cb122-10"></a><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></span>
<span id="cb122-11"><a href="customer-churn-prediction.html#cb122-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Important features&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Features&quot;</span>)</span>
<span id="cb122-12"><a href="customer-churn-prediction.html#cb122-12"></a><span class="kw">ggplotly</span>(p)</span></code></pre></div>
<div id="htmlwidget-632da8dd8c5f96f4c798" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-632da8dd8c5f96f4c798">{"x":{"data":[{"x":[114.284562677958,71.1744894220307,57.5563949449792,56.1554408606667,35.7183389630052,25.9034249224209,19.2374760032634,19.1154178341449,14.3144107689742,13.8505599480761,11.339146108834,9.74533909989096,9.58919125005946,9.11799976321088,8.99945063755728,8.96697320263558,5.96880782503479,4.39916351303441,3.68757777478931,3.1190671814027,1.8759783445361,1.78866569100458,1.76436257853464,1.51497430099762,1.20535622662455,1.03616054516428,1.01874284478363,0.989800673533369,0.93431057378761,0.571065323200638],"y":[30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1],"text":["reorder(features, MeanDecreaseGini): tenure<br />MeanDecreaseGini: 114.2845627","reorder(features, MeanDecreaseGini): TotalCharges<br />MeanDecreaseGini:  71.1744894","reorder(features, MeanDecreaseGini): InternetServiceFiber optic<br />MeanDecreaseGini:  57.5563949","reorder(features, MeanDecreaseGini): ContractTwo year<br />MeanDecreaseGini:  56.1554409","reorder(features, MeanDecreaseGini): PaymentMethodElectronic check<br />MeanDecreaseGini:  35.7183390","reorder(features, MeanDecreaseGini): MonthlyCharges<br />MeanDecreaseGini:  25.9034249","reorder(features, MeanDecreaseGini): ContractOne year<br />MeanDecreaseGini:  19.2374760","reorder(features, MeanDecreaseGini): OnlineSecurityYes<br />MeanDecreaseGini:  19.1154178","reorder(features, MeanDecreaseGini): TechSupportYes<br />MeanDecreaseGini:  14.3144108","reorder(features, MeanDecreaseGini): StreamingMoviesNo internet service<br />MeanDecreaseGini:  13.8505599","reorder(features, MeanDecreaseGini): InternetServiceNo<br />MeanDecreaseGini:  11.3391461","reorder(features, MeanDecreaseGini): OnlineSecurityNo internet service<br />MeanDecreaseGini:   9.7453391","reorder(features, MeanDecreaseGini): StreamingTVNo internet service<br />MeanDecreaseGini:   9.5891913","reorder(features, MeanDecreaseGini): TechSupportNo internet service<br />MeanDecreaseGini:   9.1179998","reorder(features, MeanDecreaseGini): OnlineBackupNo internet service<br />MeanDecreaseGini:   8.9994506","reorder(features, MeanDecreaseGini): DeviceProtectionNo internet service<br />MeanDecreaseGini:   8.9669732","reorder(features, MeanDecreaseGini): PaperlessBillingYes<br />MeanDecreaseGini:   5.9688078","reorder(features, MeanDecreaseGini): OnlineBackupYes<br />MeanDecreaseGini:   4.3991635","reorder(features, MeanDecreaseGini): Partner<br />MeanDecreaseGini:   3.6875778","reorder(features, MeanDecreaseGini): Dependents<br />MeanDecreaseGini:   3.1190672","reorder(features, MeanDecreaseGini): DeviceProtectionYes<br />MeanDecreaseGini:   1.8759783","reorder(features, MeanDecreaseGini): PaymentMethodCredit card (automatic)<br />MeanDecreaseGini:   1.7886657","reorder(features, MeanDecreaseGini): MultipleLinesYes<br />MeanDecreaseGini:   1.7643626","reorder(features, MeanDecreaseGini): PaymentMethodMailed check<br />MeanDecreaseGini:   1.5149743","reorder(features, MeanDecreaseGini): StreamingMoviesYes<br />MeanDecreaseGini:   1.2053562","reorder(features, MeanDecreaseGini): MultipleLinesNo<br />MeanDecreaseGini:   1.0361605","reorder(features, MeanDecreaseGini): MultipleLinesNo phone service<br />MeanDecreaseGini:   1.0187428","reorder(features, MeanDecreaseGini): StreamingTVYes<br />MeanDecreaseGini:   0.9898007","reorder(features, MeanDecreaseGini): PhoneService<br />MeanDecreaseGini:   0.9343106","reorder(features, MeanDecreaseGini): gender<br />MeanDecreaseGini:   0.5710653"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":235.981735159817},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Important features","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5.11460954453721,119.970237545695],"tickmode":"array","ticktext":["0","30","60","90"],"tickvals":[0,30,60,90],"categoryorder":"array","categoryarray":["0","30","60","90"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"MeanDecreaseGini","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,30.6],"tickmode":"array","ticktext":["gender","PhoneService","StreamingTVYes","MultipleLinesNo phone service","MultipleLinesNo","StreamingMoviesYes","PaymentMethodMailed check","MultipleLinesYes","PaymentMethodCredit card (automatic)","DeviceProtectionYes","Dependents","Partner","OnlineBackupYes","PaperlessBillingYes","DeviceProtectionNo internet service","OnlineBackupNo internet service","TechSupportNo internet service","StreamingTVNo internet service","OnlineSecurityNo internet service","InternetServiceNo","StreamingMoviesNo internet service","TechSupportYes","OnlineSecurityYes","ContractOne year","MonthlyCharges","PaymentMethodElectronic check","ContractTwo year","InternetServiceFiber optic","TotalCharges","tenure"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"categoryorder":"array","categoryarray":["gender","PhoneService","StreamingTVYes","MultipleLinesNo phone service","MultipleLinesNo","StreamingMoviesYes","PaymentMethodMailed check","MultipleLinesYes","PaymentMethodCredit card (automatic)","DeviceProtectionYes","Dependents","Partner","OnlineBackupYes","PaperlessBillingYes","DeviceProtectionNo internet service","OnlineBackupNo internet service","TechSupportNo internet service","StreamingTVNo internet service","OnlineSecurityNo internet service","InternetServiceNo","StreamingMoviesNo internet service","TechSupportYes","OnlineSecurityYes","ContractOne year","MonthlyCharges","PaymentMethodElectronic check","ContractTwo year","InternetServiceFiber optic","TotalCharges","tenure"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Features","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"4544742c502":{"x":{},"y":{},"type":"scatter"}},"cur_data":"4544742c502","visdat":{"4544742c502":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>As we can see from this output, the <code>tenure</code> feature seems to be the most important factor in making the final prediction. Factors such as <code>InternetServiceFiber optic</code>,<code>TotalCharges</code> and <code>ContractTwo year</code> come subsequently.</p>
</div>
<div id="evaluating-model" class="section level2">
<h2><span class="header-section-number">4.6</span> Evaluating Model</h2>
<p>In order to evaluate our model we will take a look at accuracy, precision and recall.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="customer-churn-prediction.html#cb123-1"></a><span class="co"># Evaluating Models</span></span>
<span id="cb123-2"><a href="customer-churn-prediction.html#cb123-2"></a>prediction_insample &lt;-<span class="st"> </span><span class="kw">as.double</span>(<span class="kw">predict</span>(rfModel, x_train)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb123-3"><a href="customer-churn-prediction.html#cb123-3"></a>prediction_outsample &lt;-<span class="st"> </span><span class="kw">as.double</span>(<span class="kw">predict</span>(rfModel, x_test)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span></code></pre></div>
<p>Accuracy is the percentage of correct predictions out of all predictions.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="customer-churn-prediction.html#cb124-1"></a><span class="co"># Accuracy</span></span>
<span id="cb124-2"><a href="customer-churn-prediction.html#cb124-2"></a>accu_insample &lt;-<span class="st"> </span><span class="kw">mean</span>(y_train <span class="op">==</span><span class="st"> </span>prediction_insample)</span>
<span id="cb124-3"><a href="customer-churn-prediction.html#cb124-3"></a>accu_outsample &lt;-<span class="st"> </span><span class="kw">mean</span>(y_test <span class="op">==</span><span class="st"> </span>prediction_outsample)</span>
<span id="cb124-4"><a href="customer-churn-prediction.html#cb124-4"></a><span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">&#39;In-Sample Accuracy: %0.4f&#39;</span>, accu_insample))</span></code></pre></div>
<pre><code>## [1] &quot;In-Sample Accuracy: 0.8001&quot;</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="customer-churn-prediction.html#cb126-1"></a><span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">&#39;Out-Sample Accuracy: %0.4f&#39;</span>, accu_outsample))</span></code></pre></div>
<pre><code>## [1] &quot;Out-Sample Accuracy: 0.7956&quot;</code></pre>
<p>We managed to achieve pretty good out-sample accuracy even without thorough fine-tuning our parameters.
Precision is the number of true positives divided by the total number of true positives and false positives.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="customer-churn-prediction.html#cb128-1"></a><span class="co"># Precision</span></span>
<span id="cb128-2"><a href="customer-churn-prediction.html#cb128-2"></a>prec_insample &lt;-<span class="st"> </span><span class="kw">sum</span>(prediction_insample <span class="op">&amp;</span><span class="st"> </span>y_train) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(prediction_insample)</span>
<span id="cb128-3"><a href="customer-churn-prediction.html#cb128-3"></a>prec_outsample &lt;-<span class="st"> </span><span class="kw">sum</span>(prediction_outsample <span class="op">&amp;</span><span class="st"> </span>y_test) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(prediction_outsample)</span>
<span id="cb128-4"><a href="customer-churn-prediction.html#cb128-4"></a><span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">&#39;In-Sample Precision: %0.4f&#39;</span>, prec_insample))</span></code></pre></div>
<pre><code>## [1] &quot;In-Sample Precision: 0.7043&quot;</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="customer-churn-prediction.html#cb130-1"></a><span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">&#39;Out-Sample Precision: %0.4f&#39;</span>, prec_outsample))</span></code></pre></div>
<pre><code>## [1] &quot;Out-Sample Precision: 0.6452&quot;</code></pre>
<p>Recall is defined as the number of true positives divided by number of true positives plus false negatives.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="customer-churn-prediction.html#cb132-1"></a><span class="co"># Recall </span></span>
<span id="cb132-2"><a href="customer-churn-prediction.html#cb132-2"></a>recall_insample &lt;-<span class="st"> </span><span class="kw">sum</span>(prediction_insample <span class="op">&amp;</span><span class="st"> </span>y_train) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(y_train)</span>
<span id="cb132-3"><a href="customer-churn-prediction.html#cb132-3"></a>recall_outsample &lt;-<span class="st"> </span><span class="kw">sum</span>(prediction_outsample <span class="op">&amp;</span><span class="st"> </span>y_test) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(y_test)</span>
<span id="cb132-4"><a href="customer-churn-prediction.html#cb132-4"></a><span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">&#39;In-Sample Recall: %0.4f&#39;</span>, recall_insample))</span></code></pre></div>
<pre><code>## [1] &quot;In-Sample Recall: 0.4571&quot;</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="customer-churn-prediction.html#cb134-1"></a><span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">&#39;Out-Sample Recall: %0.4f&#39;</span>, recall_outsample))</span></code></pre></div>
<pre><code>## [1] &quot;Out-Sample Recall: 0.4151&quot;</code></pre>
<p>Finally, in order to estimate how good our model is in comparison to the random prediction, we will inspect ROC curve and the <strong>A</strong>rea <strong>U</strong>nder the <strong>C</strong>urve.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="customer-churn-prediction.html#cb136-1"></a><span class="kw">library</span>(ROCR)</span>
<span id="cb136-2"><a href="customer-churn-prediction.html#cb136-2"></a></span>
<span id="cb136-3"><a href="customer-churn-prediction.html#cb136-3"></a>pred_prob_insample &lt;-<span class="st"> </span><span class="kw">as.double</span>(<span class="kw">predict</span>(rfModel, x_train, <span class="dt">type=</span><span class="st">&#39;prob&#39;</span>)[,<span class="dv">2</span>])</span>
<span id="cb136-4"><a href="customer-churn-prediction.html#cb136-4"></a>pred_prob_outsample &lt;-<span class="st"> </span><span class="kw">as.double</span>(<span class="kw">predict</span>(rfModel, x_test, <span class="dt">type=</span><span class="st">&#39;prob&#39;</span>)[,<span class="dv">2</span>])</span>
<span id="cb136-5"><a href="customer-churn-prediction.html#cb136-5"></a>pred &lt;-<span class="st"> </span><span class="kw">prediction</span>(pred_prob_outsample, y_test)</span>
<span id="cb136-6"><a href="customer-churn-prediction.html#cb136-6"></a>perf &lt;-<span class="st"> </span><span class="kw">performance</span>(pred, <span class="dt">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="dt">x.measure =</span> <span class="st">&quot;fpr&quot;</span>) </span>
<span id="cb136-7"><a href="customer-churn-prediction.html#cb136-7"></a>auc &lt;-<span class="st"> </span><span class="kw">performance</span>(pred, <span class="dt">measure=</span><span class="st">&#39;auc&#39;</span>)<span class="op">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb136-8"><a href="customer-churn-prediction.html#cb136-8"></a></span>
<span id="cb136-9"><a href="customer-churn-prediction.html#cb136-9"></a>{<span class="kw">plot</span>(perf,<span class="dt">main=</span><span class="kw">sprintf</span>(<span class="st">&#39;Random Forest (AUC: %0.2f)&#39;</span>, auc),<span class="dt">col=</span><span class="st">&#39;darkblue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">grid</span>()</span>
<span id="cb136-10"><a href="customer-churn-prediction.html#cb136-10"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">col=</span><span class="st">&#39;darkgray&#39;</span>, <span class="dt">lty=</span><span class="dv">4</span>, <span class="dt">lwd=</span><span class="dv">2</span>)}</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-99-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="references" class="section level2">
<h2><span class="header-section-number">4.7</span> References</h2>
<ul>
<li><p>Hwang, Y. H. (2019). Hands-on data science for marketing: Improve your marketing strategies with machine learning using Python and R. Birmingham: Packt Publishing.</p></li>
<li><p>W. Verbeke, D. Martens, C. Mues, B. Baesens. Building comprehensible customer churn prediction models with advanced rule induction techniques
Expert Syst. Appl., 38 (3) (2011), pp. 2354-2364.</p></li>
<li><p>M.R. Colgate, P.J. Danaher. Implementing a customer relationship strategy: the asymmetric impact of poor versus excellent execution
J. Acad. Mark. Sci., 28 (3) (2000), pp. 375-387.</p></li>
<li><p>J. Ganesh, M.J. Arnold, K.E. Reynolds. Understanding the customer base of service providers: an examination of the differences between switchers and stayers.J. Mark., 64 (3) (2000), pp. 65-87.</p></li>
<li><p>D.V. den Poel, B. Larivière. Customer attrition analysis for financial services using proportional hazard models. Eur. J. Oper. Res., 157 (1) (2004), pp. 196-217.</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="job-interview-social-media-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="prediction-with-rfm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-Random_Forest_Churn.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
