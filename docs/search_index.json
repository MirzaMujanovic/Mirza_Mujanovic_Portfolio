[
["covid-19-dashboard-for-balkan-countries.html", "4 COVID 19 Dashboard for Balkan countries* 4.1 Data 4.2 Curve of confirmed cases 4.3 Deaths vs Recovered 4.4 Total cases vs new cases", " 4 COVID 19 Dashboard for Balkan countries* 4.1 Data # Github covid19_confirmed_git &lt;-&quot;https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv&quot; covid19_confirmed_git &lt;- read_csv(url(covid19_confirmed_git)) # Worldometer codivid19_all &lt;- &quot;https://www.worldometers.info/coronavirus/&quot; main_table &lt;- codivid19_all%&gt;% xml2::read_html()%&gt;% html_nodes(xpath=&#39;//*[@id=&quot;main_table_countries_today&quot;]&#39;) %&gt;% html_table() main_table &lt;- as.data.frame(main_table) ## Filtering data for Balkan countries (plus Italy and Austria) balkan &lt;- filter(main_table,Country.Other == &quot;Bosnia and Herzegovina&quot; | Country.Other == &quot;Italy&quot; | Country.Other == &quot;Croatia&quot; | Country.Other == &quot;Serbia&quot; | Country.Other == &quot;Montenegro&quot; | Country.Other == &quot;Slovenia&quot; | Country.Other == &quot;Austria&quot; | Country.Other == &quot;North Macedonia&quot; | Country.Other == &quot;Greece&quot;) balkan$TotalCases&lt;-gsub(&quot;,&quot;, &quot;&quot;, balkan$TotalCases) balkan$NewCases&lt;-gsub(&quot;,&quot;, &quot;&quot;, balkan$NewCases) balkan$TotalRecovered&lt;-gsub(&quot;,&quot;, &quot;&quot;, balkan$TotalRecovered) balkan$TotalDeaths&lt;-gsub(&quot;,&quot;, &quot;&quot;, balkan$TotalDeaths) balkan$TotalRecovered &lt;- as.numeric(balkan$TotalRecovered) balkan$TotalDeaths &lt;- as.numeric(balkan$TotalDeaths) balkan$TotalCases&lt;-as.numeric(balkan$TotalCases) balkan$NewCases &lt;- as.numeric(balkan$NewCases) 4.2 Curve of confirmed cases # Curve of confirmed cases---- columns &lt;- colnames(covid19_confirmed_git)[5:ncol(covid19_confirmed_git)] final &lt;-as.data.frame(pivot_longer(covid19_confirmed_git, cols = columns, names_to = &quot;Year&quot;, values_to = &quot;Confirmed&quot;)) final$Year &lt;- as.Date.character(final$Year,&quot;%m/%d/%y&quot;) colnames(final) &lt;- c(&quot;Province&quot;,&quot;Country&quot;,&quot;Lat&quot;,&quot;Long&quot;,&quot;Year&quot;,&quot;Confirmed&quot;) filter &lt;- filter(final, Country == &quot;Bosnia and Herzegovina&quot; | Country == &quot;Italy&quot; | Country == &quot;Croatia&quot; | Country == &quot;Serbia&quot; | Country == &quot;Slovenia&quot; | Country == &quot;Montenegro&quot; | Country == &quot;Austria&quot; | Country == &quot;North Macedonia&quot; | Country == &quot;Greece&quot;) p &lt;-ggplot(filter, aes(x = Year, y = Confirmed)) + geom_line(aes(color = Country), size = 1) + scale_color_brewer(palette=&quot;Set1&quot;)+ theme(legend.title = element_text(size = 4),legend.text = element_text(size = 4))+ scale_y_log10(labels = comma)+ scale_x_date(date_labels = &quot;%B-%d&quot;, date_breaks = &quot;4 week&quot;)+ ylab(&quot;Confirmed cases&quot;)+ labs(caption=&quot;Data source: https://github.com/CSSEGISandData/COVID-19&quot;) ggplotly(p) 4.3 Deaths vs Recovered options(scipen = 9999) p &lt;- ggplot(balkan) + geom_segment( aes(x=Country.Other, xend=Country.Other, y=TotalRecovered, yend=TotalDeaths), color=&quot;grey&quot;) + geom_point( aes(x=Country.Other, y=TotalRecovered), color=rgb(0.2,0.7,0.1,0.5), size=3 ) + geom_point( aes(x=Country.Other, y=TotalDeaths), color=rgb(0.7,0.2,0.1,0.5), size=3 ) + coord_flip()+ scale_y_log10()+ theme_minimal() + theme( legend.position = &quot;none&quot;,) + xlab(&quot;&quot;) + ylab(&quot;Number of cases&quot;)+ ggtitle(label = &quot;Death vs Recovered&quot;) ggplotly(p) 4.4 Total cases vs new cases # Total cases vs new cases total_and_new &lt;- melt(balkan[,c(&quot;TotalCases&quot;,&quot;NewCases&quot;,&quot;Country.Other&quot;)]) p &lt;- ggplot(total_and_new, aes(x=Country.Other, y=value, fill=variable)) + geom_bar(stat=&#39;identity&#39;, position=&#39;dodge&#39;, color=&quot;black&quot; ,aes(text=paste(&quot;Country: &quot;,Country.Other, &quot;\\n&quot;, variable,&quot;:&quot;,value, sep=&quot;&quot;))) + scale_fill_brewer(palette = &quot;Paired&quot;)+ scale_y_continuous(labels=comma, trans = &quot;log10&quot;) + ylab(&quot;Number of cases&quot;)+ xlab(&quot;&quot;)+ ggtitle(label = &quot;Total cases vs New cases&quot;) + theme_minimal()+ labs(title = &quot;&quot;,fill=&quot;&quot; )+ coord_flip() ggplotly(p, tooltip = &quot;text&quot;) "]
]
