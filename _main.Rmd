--- 
knit: "bookdown::render_book"
title: "Mirza Mujanovic - Portfolio"
site: bookdown::bookdown_site
output_dir: "docs"
documentclass: book
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
---

# About me {-}

Placeholder



<!--chapter:end:index.Rmd-->


# Emotions In Online Customer Reviews 

Placeholder


## What to expect in this article? {-}
## Dictionaries for NLP
## Data set
## Corpus cleaning
## Visualisations of terms frequency
### Bar charts with the most frequent terms
### Wordcloud with the most frequent terms
### The most frequent terms indicating emotions
## Sentiment analysis
### Polarity timeline
### Analysis on sentence-level
### What are the most emotional reviews?

<!--chapter:end:01-Emotions_In_Online_Customer_Reviews.Rmd-->


# Twitter Analysis for CO2mustGo initiative

Placeholder


## Tweets distribution 
## Word Frequency in tweets with  #carbonfootprint or #co2 
##  Word Network in tweets with #carbonfootprint or #co2
## Wordcloud of words with #carbonfootprint #co2
## Sentiment analysis:
## Top retweeted Tweets
### Top retweets (with equal or more than 60 mentions)
### Interactive graph with retweets' text 
## Network of retweets
### Follower count of network users
### Putting twitter data on the map (use plotly zoom in locations!)
### Users who retweet the most
### Users who are the most retweeted
### Users with important role in allowing information to pass through network
### Clustering
### Community detection 

<!--chapter:end:02-C02_must_go_iniciative.Rmd-->


# Text Analysis of Novels

Placeholder



<!--chapter:end:03-Text_Analysis_and_Fairy_Tales.Rmd-->

---
title: "04-Covid19_Dashboard"
---

# COVID 19 Dashboard for Balkan countries*

## Data

```{r,echo=FALSE,error=FALSE,message=FALSE,warning=FALSE}
library(reshape2)
library(ggplot2)
library(dplyr)
library(rvest)
library(plotly)
library(scales)
library(wesanderson)    
library(shiny)
library(twitteR)
library(rtweet)
library(sentimentr)
library(tidyverse)
library(purrr)
library(devtools)
library(textdata)
library(ggplot2)
library(ggthemes)
library(xml2)
library(qdap)
library(wordcloud)
library(RColorBrewer)
library(NLP)
library(tm)
library(tidytext)
library(dplyr)
library(tidyr)
library(ggthemes)
library(plotly)
library(tidyverse)
library(broom)
library(remotes)
library(janeaustenr)
library(qdap)
library(glue)
library(syuzhet)
```


```{r, error=FALSE,message=FALSE,warning=FALSE}
# Github 
covid19_confirmed_git <-"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv"
covid19_confirmed_git <- read_csv(url(covid19_confirmed_git))

# Worldometer
codivid19_all <- "https://www.worldometers.info/coronavirus/"
main_table <- codivid19_all%>%
  xml2::read_html()%>%
  html_nodes(xpath='//*[@id="main_table_countries_today"]') %>%
  html_table()
main_table <- as.data.frame(main_table)

## Filtering data for Balkan countries (plus Italy and Austria)
balkan <- filter(main_table,Country.Other == "Bosnia and Herzegovina" | Country.Other == "Italy" | Country.Other == "Croatia" | Country.Other == "Serbia"  | Country.Other == "Montenegro"  | Country.Other == "Slovenia"  | Country.Other == "Austria"  | Country.Other == "North Macedonia" | Country.Other == "Greece")
balkan$TotalCases<-gsub(",", "", balkan$TotalCases)
balkan$NewCases<-gsub(",", "", balkan$NewCases)
balkan$TotalRecovered<-gsub(",", "", balkan$TotalRecovered)
balkan$TotalDeaths<-gsub(",", "", balkan$TotalDeaths)
balkan$TotalRecovered <- as.numeric(balkan$TotalRecovered)
balkan$TotalDeaths <- as.numeric(balkan$TotalDeaths)
balkan$TotalCases<-as.numeric(balkan$TotalCases)
balkan$NewCases <- as.numeric(balkan$NewCases)


```

## Curve of confirmed cases 

```{r,warning=FALSE,error=FALSE,message=FALSE,fig.width=8}
# Curve of confirmed cases----
columns <- colnames(covid19_confirmed_git)[5:ncol(covid19_confirmed_git)]
final <-as.data.frame(pivot_longer(covid19_confirmed_git, cols = columns, names_to = "Year", values_to = "Confirmed"))
final$Year <- as.Date.character(final$Year,"%m/%d/%y")
colnames(final) <- c("Province","Country","Lat","Long","Year","Confirmed") 
filter <- filter(final, Country == "Bosnia and Herzegovina" | Country == "Italy" | Country == "Croatia" | Country == "Serbia"  | Country == "Slovenia"  | Country == "Montenegro"  | Country == "Austria" | Country == "North Macedonia" | Country == "Greece")
p <-ggplot(filter, aes(x = Year, y = Confirmed)) + 
  geom_line(aes(color = Country), size = 1) +
  scale_color_brewer(palette="Set1")+
  theme(legend.title = element_text(size = 6),legend.text = element_text(size = 6))+
  scale_y_log10(labels = comma)+
  scale_x_date(date_labels = "%B-%d", date_breaks = "4 week")+
  ylab("Confirmed cases")+
  labs(caption="Data source: https://github.com/CSSEGISandData/COVID-19")
ggplotly(p)
```

## Deaths vs Recovered 

```{r}
options(scipen = 9999)
p <- ggplot(balkan) +
  geom_segment( aes(x=Country.Other, xend=Country.Other, y=TotalRecovered, yend=TotalDeaths), color="grey") +
  geom_point( aes(x=Country.Other, y=TotalRecovered), color=rgb(0.2,0.7,0.1,0.5), size=3 ) +
  geom_point( aes(x=Country.Other, y=TotalDeaths), color=rgb(0.7,0.2,0.1,0.5), size=3 ) + coord_flip()+
  scale_y_log10()+
  theme_minimal() +
  theme(
    legend.position = "none",) +
    xlab("") +
    ylab("Number of cases")+
    ggtitle(label = "Death vs Recovered")
ggplotly(p)
```

## Total cases vs new cases

```{r,error=FALSE, warning=FALSE, message=FALSE}
# Total cases vs new cases
total_and_new <- melt(balkan[,c("TotalCases","NewCases","Country.Other")])
p <- ggplot(total_and_new, aes(x=Country.Other, y=value, fill=variable)) +
  geom_bar(stat='identity', position='dodge', color="black" ,aes(text=paste("Country: ",Country.Other, "\n", variable,":",value, sep=""))) +
  scale_fill_brewer(palette = "Paired")+
  scale_y_continuous(labels=comma, trans = "log10") +
  ylab("Number of cases")+
  xlab("")+
  ggtitle(label = "Total cases vs New cases") +
  theme_minimal()+
  labs(title = "",fill="" )+
  coord_flip()
  
ggplotly(p, tooltip = "text")
```


<!--chapter:end:04-Covid19_Dashboard.Rmd-->

